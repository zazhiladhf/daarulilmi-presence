import"../chunks/DsnmJJEf.js";import"../chunks/DlWC4716.js";import{o as fa,h as ba,e as _a,s as B}from"../chunks/C-cUeD8I.js";import{p as ga,b as m,s as o,f as X,a as d,e as ha,$ as wa,g as l,m as u,h as a,c as ka,d as e,r as s,t as _,k as ya,o as Y,n as Z}from"../chunks/DVhLo0Kx.js";import{i as g}from"../chunks/Bj3ioQdl.js";import{r as D}from"../chunks/BMwGc5xt.js";import{b as H}from"../chunks/CbjkAijc.js";import{b as Sa}from"../chunks/B93iMbHO.js";import{p as xa}from"../chunks/D4Caz1gY.js";import{i as $a}from"../chunks/CSakOhqG.js";import{s as Ma,a as Na}from"../chunks/H2P4P_7E.js";import{p as Ta}from"../chunks/DNHlrJ5z.js";import{i as ja,g as Aa}from"../chunks/Fs8NSvnN.js";var Ia=m("<p>Memuat data...</p>"),qa=m('<div class="alert alert-danger"> </div>'),za=m('<div class="alert alert-success"> </div>'),Ea=m('<span class="spinner-border spinner-border-sm"></span> Menyimpan...',1),Ka=m('<i class="bi bi-save"></i> Simpan Perubahan',1),Ba=m('<div class="row"><div class="col-lg-8"><div class="card shadow-sm"><div class="card-body"><!> <!> <form><div class="mb-3"><label for="nisn" class="form-label">NISN Siswa</label> <input type="text" class="form-control" id="nisn" required/></div> <div class="row"><div class="col-md-6 mb-3"><label for="tanggal" class="form-label">Tanggal</label> <input type="date" class="form-control" id="tanggal" required/></div> <div class="col-md-6 mb-3"><label for="waktu" class="form-label">Waktu (Jam:Menit)</label> <input type="time" class="form-control" id="waktu" required/></div></div> <div class="mb-3"><label for="status" class="form-label">Status Kehadiran</label> <select class="form-select" id="status" required><option>Hadir</option><option>Sakit</option><option>Izin</option><option>Alpa</option></select></div> <button type="submit" class="btn btn-primary"><!></button></form></div></div></div></div>'),Da=m('<div class="alert alert-danger"> </div>'),Ha=m('<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"><h1 class="h2">Edit Kehadiran Manual</h1> <a href="/dashboard/kehadiran" class="btn btn-sm btn-outline-secondary"><i class="bi bi-arrow-left"></i> Kembali</a></div> <!>',1);function Za(aa,ta){ga(ta,!1);const[ea,sa]=Na(),J=Ma(Ta,"$page",ea).params.row;let x="",r=u(null),h=u(""),w=u(""),P=u(!0),k=u(!1),f=u(""),y=u("");fa(async()=>{{x=localStorage.getItem("jwt_token")||"";try{const i=await fetch(`http://localhost:1412/api/absensi/log/${J}`,{headers:{Authorization:"Bearer "+x}});if(!i.ok)throw new Error("Gagal mengambil data absensi.");if(l(r,await i.json()),a(r)&&a(r).timestamp){const[n,p]=a(r).timestamp.split(" ");l(h,n),l(w,p?p.substring(0,5):"07:00")}}catch(i){l(f,i.message)}finally{l(P,!1)}}});async function ra(){l(k,!0),l(f,""),l(y,"");const i=`${a(h)} ${a(w)}:00`;try{const n=await fetch(`http://localhost:1412/api/absensi/log/${J}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+x},body:JSON.stringify({NISN:a(r).username,Status:a(r).status,Timestamp:i})}),p=await n.json();if(!n.ok)throw new Error(p.message);l(y,p.message),await ja(),setTimeout(()=>{Aa("/dashboard/kehadiran")},1e3)}catch(n){l(f,n.message)}finally{l(k,!1)}}$a();var U=Ha();ba(i=>{wa.title="Edit Kehadiran"});var ia=o(X(U),2);{var oa=i=>{var n=Ia();d(i,n)},la=i=>{var n=ka(),p=X(n);{var na=b=>{var c=Ba(),S=e(c),C=e(S),G=e(C),L=e(G);{var da=t=>{var v=qa(),K=e(v,!0);s(v),_(()=>B(K,a(f))),d(t,v)};g(L,t=>{a(f)&&t(da)})}var O=o(L,2);{var ma=t=>{var v=za(),K=e(v,!0);s(v),_(()=>B(K,a(y))),d(t,v)};g(O,t=>{a(y)&&t(ma)})}var $=o(O,2),M=e($),W=o(e(M),2);D(W),s(M);var N=o(M,2),T=e(N),F=o(e(T),2);D(F),s(T);var Q=o(T,2),R=o(e(Q),2);D(R),s(Q),s(N);var j=o(N,2),A=o(e(j),2);_(()=>{a(r),ya(()=>{})});var I=e(A);I.value=I.__value="Hadir";var q=o(I);q.value=q.__value="Sakit";var z=o(q);z.value=z.__value="Izin";var V=o(z);V.value=V.__value="Alpa",s(A),s(j);var E=o(j,2),pa=e(E);{var ca=t=>{var v=Ea();Z(),d(t,v)},ua=t=>{var v=Ka();Z(),d(t,v)};g(pa,t=>{a(k)?t(ca):t(ua,!1)})}s(E),s($),s(G),s(C),s(S),s(c),_(()=>E.disabled=a(k)),H(W,()=>a(r).username,t=>Y(r,a(r).username=t)),H(F,()=>a(h),t=>l(h,t)),H(R,()=>a(w),t=>l(w,t)),Sa(A,()=>a(r).status,t=>Y(r,a(r).status=t)),_a("submit",$,xa(ra)),d(b,c)},va=b=>{var c=Da(),S=e(c,!0);s(c),_(()=>B(S,a(f)||"Data absensi tidak ditemukan.")),d(b,c)};g(p,b=>{a(r)?b(na):b(va,!1)},!0)}d(i,n)};g(ia,i=>{a(P)?i(oa):i(la,!1)})}d(aa,U),ha(),sa()}export{Za as component};
